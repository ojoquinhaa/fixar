{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import View from\"react-native-web/dist/exports/View\";import useWindowDimensions from\"react-native-web/dist/exports/useWindowDimensions\";import Image from\"react-native-web/dist/exports/Image\";import Pressable from\"react-native-web/dist/exports/Pressable\";import Button from\"react-native-paper/lib/module/components/Button/Button\";import TextInput from\"react-native-paper/lib/module/components/TextInput/TextInput\";import{useTheme}from\"react-native-paper/lib/module/core/theming\";import{getLoginStyleSheet}from\"../../styles\";import{useEffect,useState}from\"react\";import UserAPI from\"../../API/User\";import SecuryStory from\"expo-secure-store\";import Platform from\"react-native-web/dist/exports/Platform\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(props){var window=useWindowDimensions();var theme=useTheme();var styles=getLoginStyleSheet(window,theme);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];useEffect(function(){if(Platform.OS!==\"web\"){SecuryStory.getItemAsync(\"token\").then(function(token){if(token){props.setToken(token);props.setLogged(true);}});}});function loginHandler(){return _loginHandler.apply(this,arguments);}function _loginHandler(){_loginHandler=_asyncToGenerator(function*(){if(user===\"\"||password===\"\"){alert(\"Credenciáis inválidas.\");return;}var api=new UserAPI(user,password);var data=yield api.login();if(data.token){alert(\"Logado com successo!\");if(Platform.OS!==\"web\"){yield SecuryStory.setItemAsync(\"token\",data.token);}props.setLogged(true);props.setToken(data.token);return;}alert(\"Credenciáis inválidas.\");});return _loginHandler.apply(this,arguments);}return _jsxs(View,{style:styles.login,children:[_jsx(Image,{source:require(\"../../assets/icon.png\"),style:styles.logo}),_jsxs(View,{style:styles.form,children:[_jsx(TextInput,{label:\"Usu\\xE1rio\",mode:\"flat\",style:styles.input,onChangeText:function onChangeText(text){return setUser(text);},value:user}),_jsx(TextInput,{label:\"Senha\",mode:\"flat\",secureTextEntry:true,style:styles.input,onChangeText:function onChangeText(text){return setPassword(text);},value:password}),_jsx(Pressable,{style:styles.input,children:_jsx(Button,{mode:\"contained\",style:styles.button,dark:true,onPress:loginHandler,children:\"Enviar\"})})]})]},\"Login\");}","map":{"version":3,"names":["getLoginStyleSheet","useEffect","useState","UserAPI","SecuryStory","Platform","jsx","_jsx","jsxs","_jsxs","Login","props","window","useWindowDimensions","theme","useTheme","styles","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","password","setPassword","OS","getItemAsync","then","token","setToken","setLogged","loginHandler","_loginHandler","apply","arguments","_asyncToGenerator","alert","api","data","login","setItemAsync","View","style","children","Image","source","require","logo","form","TextInput","label","mode","input","onChangeText","text","value","secureTextEntry","Pressable","Button","button","dark","onPress"],"sources":["/home/ojoquinhaa/Documentos/trabalho/inktone/frontend/components/Screen/Login.tsx"],"sourcesContent":["import { View, useWindowDimensions, Image, Pressable } from \"react-native\";\nimport { Button, TextInput, useTheme } from \"react-native-paper\";\nimport { getLoginStyleSheet } from \"../../styles\";\nimport { Dispatch, SetStateAction, useEffect, useState } from \"react\";\nimport UserAPI from \"../../API/User\";\nimport SecuryStory from \"expo-secure-store\";\nimport { Platform } from \"react-native\";\n\ntype props = {\n  logged: boolean;\n  setLogged: Dispatch<SetStateAction<boolean>>;\n  setToken: Dispatch<SetStateAction<string>>;\n};\n\nexport default function Login(props: props): JSX.Element {\n  const window = useWindowDimensions();\n  const theme = useTheme();\n  const styles = getLoginStyleSheet(window, theme);\n\n  const [user, setUser] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  useEffect(() => {\n    if (Platform.OS !== \"web\") {\n      SecuryStory.getItemAsync(\"token\").then((token) => {\n        if (token) {\n          props.setToken(token);\n          props.setLogged(true);\n        }\n      });\n    }\n  });\n\n  async function loginHandler(): Promise<void> {\n    if (user === \"\" || password === \"\") {\n      alert(\"Credenciáis inválidas.\");\n      return;\n    }\n\n    const api = new UserAPI(user, password);\n    const data = await api.login();\n\n    if (data.token) {\n      alert(\"Logado com successo!\");\n      if (Platform.OS !== \"web\") {\n        await SecuryStory.setItemAsync(\"token\", data.token);\n      }\n      props.setLogged(true);\n      props.setToken(data.token);\n      return;\n    }\n\n    alert(\"Credenciáis inválidas.\");\n  }\n\n  return (\n    <View style={styles.login} key=\"Login\">\n      <Image source={require(\"../../assets/icon.png\")} style={styles.logo} />\n      <View style={styles.form}>\n        <TextInput\n          label=\"Usuário\"\n          mode=\"flat\"\n          style={styles.input}\n          onChangeText={(text) => setUser(text)}\n          value={user}\n        />\n        <TextInput\n          label=\"Senha\"\n          mode=\"flat\"\n          secureTextEntry={true}\n          style={styles.input}\n          onChangeText={(text) => setPassword(text)}\n          value={password}\n        />\n        <Pressable style={styles.input}>\n          <Button\n            mode=\"contained\"\n            style={styles.button}\n            dark={true}\n            onPress={loginHandler}\n          >\n            Enviar\n          </Button>\n        </Pressable>\n      </View>\n    </View>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}